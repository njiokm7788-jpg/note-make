# 上传状态条交互规格

## 组件定位

上传状态条是一个紧凑的水平条，位于 Header 下方，始终可见。它的职责是:
1. 展示当前两张图片的上传状态
2. 提供快速更换图片的入口
3. 作为展开上传抽屉的触发器

---

## 状态定义

### 1. 未上传任何图片 (empty)

**视觉表现**:
```
+------------------------------------------------------------------+
| [+] 点击上传图片，或拖拽文件到此处                    [Ctrl+V 粘贴] |
+------------------------------------------------------------------+
```

**样式规格**:
- 背景: `bg-slate-50` 浅灰底色
- 边框: `border border-dashed border-slate-300` 虚线边框
- 图标: `+` 加号图标，`text-slate-400`
- 文字: `text-slate-500 text-sm`
- 高度: `h-12` (48px)
- 圆角: `rounded-lg`

**交互行为**:
- 点击任意位置 -> 展开上传抽屉
- 悬停: `hover:border-primary-400 hover:bg-primary-50` 边框和背景变色
- 拖拽文件进入: 切换到拖拽激活状态

---

### 2. 仅上传原图 (partial-original)

**视觉表现**:
```
+------------------------------------------------------------------+
| [缩略图] 原图.jpg                    | [虚线框] 请上传标注图 | [更换] |
+------------------------------------------------------------------+
```

**样式规格**:
- 左侧原图区:
  - 缩略图: `w-8 h-8 rounded object-cover`
  - 文件名: `text-sm text-slate-700 truncate max-w-[120px]`
  - 状态图标: 绿色勾 `text-green-500`
- 右侧标注图区:
  - 虚线框: `border border-dashed border-amber-400 bg-amber-50`
  - 提示文字: `text-amber-600 text-sm`
  - 脉冲动画: `animate-pulse` 轻微闪烁提示
- 更换按钮: `text-primary-600 text-sm hover:underline`

**交互行为**:
- 点击左侧原图区 -> 展开抽屉，聚焦原图上传
- 点击右侧标注图区 -> 展开抽屉，聚焦标注图上传
- 点击更换按钮 -> 展开抽屉

---

### 3. 仅上传标注图 (partial-annotated)

**视觉表现**:
```
+------------------------------------------------------------------+
| [虚线框] 请上传原图                  | [缩略图] 标注.jpg    | [更换] |
+------------------------------------------------------------------+
```

**样式规格**:
- 与 partial-original 镜像对称
- 左侧原图区显示虚线框和提示
- 右侧标注图区显示缩略图和文件名

**交互行为**:
- 同 partial-original，点击对应区域展开抽屉

---

### 4. 两张都已上传 (complete)

**视觉表现**:
```
+------------------------------------------------------------------+
| [缩略图] 原图.jpg [勾]  |  [缩略图] 标注.jpg [勾]  | [更换] [清空] |
+------------------------------------------------------------------+
```

**样式规格**:
- 背景: `bg-green-50` 浅绿底色表示完成
- 边框: `border border-green-200` 绿色边框
- 两侧图片区:
  - 缩略图: `w-8 h-8 rounded object-cover ring-2 ring-green-400`
  - 文件名: `text-sm text-slate-700`
  - 勾选图标: `text-green-500 w-4 h-4`
- 操作按钮:
  - 更换: `text-primary-600 text-sm`
  - 清空: `text-slate-400 text-sm hover:text-red-500`

**交互行为**:
- 点击任一图片区 -> 展开抽屉，可更换对应图片
- 点击更换 -> 展开抽屉
- 点击清空 -> 确认对话框 -> 清除两张图片

---

### 5. 上传中状态 (uploading)

**视觉表现**:
```
+------------------------------------------------------------------+
| [缩略图] 原图.jpg [勾]  |  [进度条] 上传中 45%...  | [取消]        |
+------------------------------------------------------------------+
```

**样式规格**:
- 上传中的图片位置:
  - 进度条: `h-1 bg-primary-500 rounded-full` 动态宽度
  - 百分比: `text-xs text-primary-600`
  - 加载动画: 旋转图标 `animate-spin`
- 取消按钮: `text-slate-400 hover:text-red-500`

**交互行为**:
- 点击取消 -> 中止上传，恢复之前状态
- 上传完成 -> 自动切换到 complete 状态
- 上传失败 -> 切换到 error 状态

---

### 6. 上传失败状态 (error)

**视觉表现**:
```
+------------------------------------------------------------------+
| [缩略图] 原图.jpg [勾]  |  [!] 上传失败: 文件过大  | [重试] [取消] |
+------------------------------------------------------------------+
```

**样式规格**:
- 错误区域:
  - 背景: `bg-red-50`
  - 图标: `!` 感叹号 `text-red-500`
  - 错误信息: `text-red-600 text-sm`
- 操作按钮:
  - 重试: `text-primary-600`
  - 取消: `text-slate-400`

**交互行为**:
- 点击重试 -> 重新上传
- 点击取消 -> 清除失败的文件，恢复之前状态
- 3秒后自动隐藏错误信息（保留重试入口）

---

## 状态转换图

```
                    +--------+
                    | empty  |
                    +--------+
                        |
            +-----------+-----------+
            |                       |
            v                       v
    +----------------+      +------------------+
    | partial-orig   |      | partial-annotated|
    +----------------+      +------------------+
            |                       |
            +-----------+-----------+
                        |
                        v
                   +----------+
                   | complete |
                   +----------+
                        |
            +-----------+-----------+
            |                       |
            v                       v
       +-----------+          +---------+
       | uploading |--------->| error   |
       +-----------+          +---------+
            |                       |
            v                       v
       +----------+           +----------+
       | complete |           | partial  |
       +----------+           +----------+
```

---

## 缩略图生成规则

1. **尺寸**: 32x32px (w-8 h-8)
2. **裁剪**: `object-cover` 居中裁剪
3. **圆角**: `rounded` (4px)
4. **加载**: 显示骨架屏 `bg-slate-200 animate-pulse`
5. **失败**: 显示占位图标 `ImageIcon text-slate-400`

---

## 文件名显示规则

1. **最大宽度**: 120px
2. **截断**: `truncate` 省略号
3. **悬停**: `title` 属性显示完整文件名
4. **格式**: 保留扩展名

---

## 拖拽激活状态

当文件被拖拽到状态条上方时:

**视觉变化**:
- 边框: `border-2 border-primary-500 border-dashed`
- 背景: `bg-primary-50`
- 文字: "释放以上传图片"
- 图标: 上传箭头动画

**交互行为**:
- 释放文件 -> 智能分配到原图或标注图位置
- 拖离区域 -> 恢复原状态
