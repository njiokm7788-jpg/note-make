# Layout Restructuring Strategy

## 1. Design Principles for Compact Layout

### Core Principle: "Single Screen Operation"
用户应能在不滚动的情况下完成 80% 的操作流程。

### Supporting Principles
1. **水平优先**: 优先利用水平空间，减少垂直堆叠
2. **渐进披露**: 高级选项默认隐藏，按需展开
3. **紧凑间距**: 使用更小的 padding/gap，但保持可点击性
4. **智能折叠**: 根据内容状态动态调整区域高度

## 2. Proposed Layout Structure

### Option A: Horizontal Upload Layout (Recommended)

```
┌─────────────────────────────────────────────────────────────────┐
│ [Logo] 笔记图片叠加工具          [单张处理] [批量处理]          │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │  上传图片                                                │   │
│  │  ┌──────────────────────┐  ┌──────────────────────┐     │   │
│  │  │     原始图片          │  │    AI标注图片         │     │   │
│  │  │   [拖拽/点击上传]     │  │   [拖拽/点击上传]     │     │   │
│  │  └──────────────────────┘  └──────────────────────┘     │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  ┌──────────────────────────────┐  ┌────────────────────────┐  │
│  │  处理设置                     │  │  处理预览              │  │
│  │  [标准] [精细] [快速]         │  │                        │  │
│  │  ┌─ 高级设置 ─────────────┐  │  │   [预览图/结果]        │  │
│  │  │ 阈值: ═══════○         │  │  │                        │  │
│  │  │ 膨胀: ═══○             │  │  │                        │  │
│  │  └────────────────────────┘  │  │                        │  │
│  │  [☑ 实时预览]    [下载结果]  │  │  [查看对比] [下载]     │  │
│  └──────────────────────────────┘  └────────────────────────┘  │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│                    笔记图片叠加工具 - ...                        │
└─────────────────────────────────────────────────────────────────┘
```

**优势**:
- 上传区水平排列，高度减少 50%
- 设置和预览并排，充分利用水平空间
- 所有核心操作在首屏可见

### Option B: Sidebar Settings Layout

```
┌─────────────────────────────────────────────────────────────────┐
│ [Logo] 笔记图片叠加工具          [单张处理] [批量处理]          │
├────────────────────────────────────────────────────┬────────────┤
│                                                    │            │
│  ┌──────────────────┐  ┌──────────────────┐       │  处理设置  │
│  │   原始图片        │  │   AI标注图片      │       │            │
│  │  [上传区]         │  │  [上传区]         │       │  [预设]    │
│  └──────────────────┘  └──────────────────┘       │            │
│                                                    │  [参数]    │
│  ┌─────────────────────────────────────────────┐  │            │
│  │                                             │  │  [开关]    │
│  │              处理预览                        │  │            │
│  │                                             │  │  [按钮]    │
│  │                                             │  │            │
│  └─────────────────────────────────────────────┘  │            │
│                                                    │            │
└────────────────────────────────────────────────────┴────────────┘
```

**优势**:
- 设置面板固定在右侧，始终可见
- 预览区域最大化
- 适合频繁调参场景

### Option C: Tabbed Sections Layout

```
┌─────────────────────────────────────────────────────────────────┐
│ [Logo] 笔记图片叠加工具          [单张处理] [批量处理]          │
├─────────────────────────────────────────────────────────────────┤
│  [上传] [设置] [预览]                                           │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                                                         │   │
│  │              当前 Tab 内容区域                           │   │
│  │              (根据选中 Tab 切换)                         │   │
│  │                                                         │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │  [上一步]                              [下一步/处理]     │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**优势**:
- 每个步骤独占全屏，无滚动
- 引导式操作流程
- 适合新手用户

**劣势**:
- 无法同时查看上传和预览
- 增加点击次数

## 3. Recommended Solution: Option A Enhanced

基于用户需求"紧凑高效"和"保持 Tab 标签页"，推荐 **Option A** 的增强版本。

### Grid System Redesign

**Current**: `lg:grid-cols-3` (1:2 ratio)
**Proposed**: `lg:grid-cols-12` (flexible ratio)

```css
/* 新布局网格 */
.layout-single {
  display: grid;
  grid-template-columns: repeat(12, 1fr);
  grid-template-rows: auto 1fr;
  gap: 16px; /* 从 24px 压缩 */
}

.upload-section {
  grid-column: span 12; /* 全宽 */
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
}

.settings-section {
  grid-column: span 5; /* 约 42% */
}

.preview-section {
  grid-column: span 7; /* 约 58% */
}
```

### Height Budget (1080px viewport)

| 区域 | 当前高度 | 目标高度 | 节省 |
|-----|---------|---------|------|
| Header | 64px | 56px | 8px |
| Main padding | 32px | 16px | 16px |
| 上传区 | 420px | 180px | **240px** |
| Gap | 24px | 16px | 8px |
| 设置+预览 | 450px | 350px | 100px |
| Footer | 56px | 48px | 8px |
| **Total** | 1046px | **666px** | **380px** |

### Wireframe: Compact Single Mode

```
┌─────────────────────────────────────────────────────────────────┐
│ [Logo] 笔记图片叠加工具                [单张] [批量]    h=56px  │
├─────────────────────────────────────────────────────────────────┤
│ p=16px                                                          │
│  ┌────────────────────────────┬────────────────────────────┐   │
│  │ 原始图片                    │ AI标注图片                  │   │
│  │ ┌────────────────────────┐ │ ┌────────────────────────┐ │   │
│  │ │  [缩略图/上传区]        │ │ │  [缩略图/上传区]        │ │   │
│  │ │  h=120px               │ │ │  h=120px               │ │   │
│  │ └────────────────────────┘ │ └────────────────────────┘ │   │
│  │ 文件名.jpg                 │ 文件名_标注.jpg             │   │
│  └────────────────────────────┴────────────────────────────┘   │
│  h=180px total                                                  │
│  gap=16px                                                       │
│  ┌─────────────────────┬───────────────────────────────────┐   │
│  │ 处理设置             │ 处理预览                          │   │
│  │ ┌─────────────────┐ │ ┌───────────────────────────────┐ │   │
│  │ │[标准][精细][快速]│ │ │                               │ │   │
│  │ └─────────────────┘ │ │                               │ │   │
│  │ ▸ 高级设置          │ │      [预览图像]                │ │   │
│  │ ┌─────────────────┐ │ │      max-h=280px              │ │   │
│  │ │ 阈值 ════○ 200  │ │ │                               │ │   │
│  │ │ 膨胀 ══○   3px  │ │ │                               │ │   │
│  │ └─────────────────┘ │ └───────────────────────────────┘ │   │
│  │ [☑ 实时预览]        │ [查看对比]          [下载结果]    │   │
│  │ h=350px             │ h=350px                           │   │
│  └─────────────────────┴───────────────────────────────────┘   │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│ 笔记图片叠加工具 - 让AI标注与清晰原图完美结合          h=48px   │
└─────────────────────────────────────────────────────────────────┘
```

## 4. Batch Mode Layout Optimization

### Current Issues
- BatchProcessor 占 2/3，设置占 1/3
- 配对列表 max-h-60 (240px) 可能不够
- 设置面板重复代码

### Proposed Batch Layout

```
┌─────────────────────────────────────────────────────────────────┐
│ [Logo] 笔记图片叠加工具                [单张] [批量]            │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │ 批量处理                                    已添加 5 对  │   │
│  │ ┌─────────────────────────────────────────────────────┐ │   │
│  │ │  拖拽多个图片文件到此处，或 点击选择                  │ │   │
│  │ │  系统会自动匹配原图和标注图                          │ │   │
│  │ └─────────────────────────────────────────────────────┘ │   │
│  └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│  ┌──────────────────────────────────┬──────────────────────┐   │
│  │ 配对列表                          │ 处理设置             │   │
│  │ ┌──────────────────────────────┐ │ [标准][精细][快速]   │   │
│  │ │ file1.jpg + file1_标注.jpg  ✕│ │                      │   │
│  │ │ file2.jpg + file2_标注.jpg  ✕│ │ 阈值 ════○ 200      │   │
│  │ │ file3.jpg + file3_标注.jpg  ✕│ │ 膨胀 ══○   3px      │   │
│  │ │ ...                          │ │ 透明度 ═══○ 80%     │   │
│  │ └──────────────────────────────┘ │                      │   │
│  │ [清空列表]                        │ [批量处理并下载]     │   │
│  └──────────────────────────────────┴──────────────────────┘   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

## 5. Spacing System Optimization

### Current Spacing (Tailwind)
- Card padding: `p-6` (24px)
- Section gap: `gap-6` (24px)
- Inner gap: `gap-4` (16px)
- Button padding: `py-3 px-4` (12px/16px)

### Proposed Compact Spacing
- Card padding: `p-4` (16px)
- Section gap: `gap-4` (16px)
- Inner gap: `gap-3` (12px)
- Button padding: `py-2.5 px-3` (10px/12px)

### Space Savings Calculation

| Element | Current | Proposed | Savings per instance |
|---------|---------|----------|---------------------|
| Card padding | 48px (top+bottom) | 32px | 16px |
| Section gap | 24px | 16px | 8px |
| Inner gap | 16px | 12px | 4px |
| Button height | ~48px | ~40px | 8px |

**Total vertical savings**: ~100-150px

## 6. Responsive Considerations

### Breakpoint Strategy

```css
/* Mobile First */
@media (min-width: 640px) { /* sm */ }
@media (min-width: 768px) { /* md */ }
@media (min-width: 1024px) { /* lg - main breakpoint */ }
@media (min-width: 1280px) { /* xl */ }
```

### Layout Behavior by Breakpoint

| Breakpoint | Upload | Settings + Preview |
|------------|--------|-------------------|
| < 768px | 垂直堆叠 | 垂直堆叠 |
| 768-1024px | 水平并排 | 垂直堆叠 |
| >= 1024px | 水平并排 | 水平并排 |

### Mobile Optimization
- 上传区使用 Accordion 折叠
- 设置面板使用 Bottom Sheet
- 预览使用全屏模态框
